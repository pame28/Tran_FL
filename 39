public bool EsTarjetaMigrada(string counterpartCard)
{
    try
    {
        using var connection = new SqlConnection(_migradasConnection);

        var resultado = connection.QueryFirstOrDefault<int>(
            "usp_EsTarjetaMigrada",
            new { Equivalente = counterpartCard },
            commandType: CommandType.StoredProcedure
        );

        _logger.Info($"Tarjeta {counterpartCard} migrada: {(resultado == 1)}");

        return resultado == 1;
    }
    catch (Exception ex)
    {
        _logger.Error(
            $"Error al validar si la tarjeta {counterpartCard} es migrada. Se continÃºa flujo legacy.",
            ex
        );

        // ðŸ”’ Fail-safe bancario: si falla la validaciÃ³n â†’ legacy
        return false;
    }
}
