System.Data.OleDb.OleDbException: 'SQL0204: REIMQ07RC en BPPGM de tipo *N no encontrado.
Causa . . . . . :   REIMQ07RC en BPPGM tipo *N no se ha encontrado. Si el nombre del miembro es *ALL, la tabla no se particiona. Si se trata de una sentencia ALTER TABLE y el tipo es *N, no se ha encontrado una restricción o partición. Si no se trata de una sentencia ALTER TABLE y el tipo es *N, no se ha encontrado una función, procedimiento, desencadenante u objeto de secuencia. Si no se ha encontrado una función, REIMQ07RC es el programa de servicio que contiene la función. La función no se encontrará a menos que el nombre externo y el nombre de uso coincidan exactamente. Una función no se considera candidata a menos que el usuario tenga el privilegio EXECUTE sobre la función.  Examine en las anotaciones de trabajo para ver si encuentra un mensaje que dé más detalles sobre el nombre de función que se está buscando y el nombre que no coincide. Recuperación . . . :   Cambie el nombre y vuelva a intentar la petición. Si el objeto es un grupo de nodos, asegúrese de que el producto DB2 Multisystem está instalado en el sistema y cree un grupo de nodos con el mandato CL CRTNODGRP. Si no se ha encontrado la función externa, asegúrese de que las mayúsculas y minúsculas del EXTERNAL NAME en la sentencia CREATE FUNCTION coinciden exactamente con las mayúsculas y minúsculas del nombre exportado por el programa de servicio.'




using System;
using System.Data;
using System.Data.Odbc;
using System.Data.OleDb;

namespace AperturaMasiva
{
    public class CPN
    {
        public void EjecutaPGM()
        {
            // ============================
            // CONEXIÓN OLEDB A AS400
            // ============================
            string connectionString =
                "Provider=IBMDA400.DataSource.1;" +
                "Data Source=****;" +
                "User ID=*****;" +
                "Password=*****;" +
                "Initial Catalog=SBP720P;" +
                "Persist Security Info=True;" +
                "Catalog Library List=DP053DAT; Library List=CLIDAT; Library List=BPDAT; Library List=BPPGM; Library List=TARJETA;";
            using var conn = new OleDbConnection(connectionString);

            // ============================
            // CONSTRUCCIÓN TRAMA (81)
            // ============================
            string trama =
                "5007".PadRight(16) +   // 1–16  Equivalente TC
                "20280831" +            // 17–24 Fecha Vencimiento
                "2802" +                // 25–28 PIN
                "".PadRight(3) +        // 29–31 Código Error
                "".PadRight(50);        // 32–81 Descripción Error

            // ============================
            // CALL AL PROGRAMA RPG
            // ============================
            using var cmd = new OleDbCommand(
                "CALL BPPGM.REIMQ07RC(?)",
                conn
            );

            cmd.CommandType = CommandType.Text;
            cmd.CommandTimeout = 300;

            // ============================
            // PARÁMETRO IN/OUT
            // ============================
            var pTrama = new OleDbParameter
            {
                OleDbType = OleDbType.Char,
                Size = 81,
                Direction = ParameterDirection.InputOutput,
                Value = trama
            };

            cmd.Parameters.Add(pTrama);

            // ============================
            // EJECUCIÓN
            // ============================
            conn.Open();
            cmd.ExecuteNonQuery();
            conn.Close();

            // ============================
            // RESPUESTA
            // ============================
            string tramaSalida = pTrama.Value.ToString();

            string codigoError = tramaSalida.Substring(28, 3);
            string descripcionError = tramaSalida.Substring(31, 50);

            Console.WriteLine("TRAMA SALIDA : " + tramaSalida);
            Console.WriteLine("COD ERROR    : " + codigoError);
            Console.WriteLine("DESC ERROR   : " + descripcionError);
        }
    }
}
