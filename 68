using System;
using System.Data;
using System.Data.OleDb;

class Program
{
    static void Main()
    {
        string connectionString =
            "Provider=IBMDA400;" +
            "Data Source=MI_AS400;" +
            "User ID=USUARIO;" +
            "Password=PASSWORD;";

        // Trama inicial (81 chars)
        string trama = new string(' ', 81);

        using (OleDbConnection conn = new OleDbConnection(connectionString))
        {
            conn.Open();

            OleDbCommand cmd = new OleDbCommand(
                "CALL BPPGM.SP_REIMQ07RC(?)", conn);

            OleDbParameter param = new OleDbParameter
            {
                ParameterName = "V_INFO",
                OleDbType = OleDbType.Char,
                Size = 81,
                Direction = ParameterDirection.InputOutput,
                Value = trama
            };

            cmd.Parameters.Add(param);

            cmd.ExecuteNonQuery();

            string tramaSalida = param.Value.ToString();

            Console.WriteLine("TRAMA DEVUELTA:");
            Console.WriteLine($"[{tramaSalida}]");
        }
    }
}
