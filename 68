using System;
using System.Data;
using System.Data.OleDb;

class Program
{
    static string ConstruirTrama(string equivalenteTC, string fechaVencimiento, string pin)
    {
        string trama = string.Empty;
        trama += equivalenteTC.PadRight(16);
        trama += fechaVencimiento.PadRight(8);
        trama += pin.PadRight(4);
        trama += "".PadRight(53); // Resto de la trama para completar 81
        return trama.PadRight(81);
    }

    static void Main()
    {
        string connectionString =
            "Provider=IBMDA400;" +
            "Data Source=MI_AS400;" +
            "User ID=USUARIO;" +
            "Password=PASSWORD;";

        string trama = ConstruirTrama("1234567890123456", "20261231", "1234");

        using (OleDbConnection conn = new OleDbConnection(connectionString))
        {
            conn.Open();

            OleDbCommand cmd = new OleDbCommand("CALL BPPGM.REIMQ07RC(?)", conn);

            OleDbParameter param = new OleDbParameter
            {
                OleDbType = OleDbType.Char,
                Size = 81,
                Direction = ParameterDirection.InputOutput,
                Value = trama
            };

            cmd.Parameters.Add(param);

            cmd.ExecuteNonQuery();

            // Imprimir la trama completa de salida
            string tramaSalida = param.Value.ToString();
            Console.WriteLine("TRAMA DEVUELTA:");
            Console.WriteLine($"[{tramaSalida}]");
        }
    }
}
