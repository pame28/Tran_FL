static string ConstruirTrama(
    string equivalenteTC,
    string fechaVencimiento,
    string pin)
{
    string trama = string.Empty;

    trama += equivalenteTC.PadRight(16);      // 1-16
    trama += fechaVencimiento.PadRight(8);     // 17-24
    trama += pin.PadRight(4);                  // 25-28
    trama += "".PadRight(3);                   // 29-31 (error)
    trama += "".PadRight(50);                  // 32-81 (desc)

    return trama.PadRight(81);
}







using System;
using System.Data;
using System.Data.OleDb;

class Program
{
    static void Main()
    {
        string connectionString =
            "Provider=IBMDA400;" +
            "Data Source=MI_AS400;" +
            "User ID=USUARIO;" +
            "Password=PASSWORD;";

        string trama = ConstruirTrama(
            "1234567890123456",
            "20261231",
            "1234"
        );

        using (OleDbConnection conn = new OleDbConnection(connectionString))
        {
            conn.Open();

            OleDbCommand cmd = new OleDbCommand(
                "CALL BPPGM.REIMQ07RC(?)", conn);

            OleDbParameter param = new OleDbParameter();
            param.OleDbType = OleDbType.Char;
            param.Size = 81;
            param.Direction = ParameterDirection.InputOutput;
            param.Value = trama;

            cmd.Parameters.Add(param);

            cmd.ExecuteNonQuery();

            string tramaSalida = param.Value.ToString();

            ProcesarRespuesta(tramaSalida);
        }
    }










static void ProcesarRespuesta(string trama)
{
    string codigoError = trama.Substring(28, 3).Trim(); // 29-31
    string descripcion = trama.Substring(31, 50).Trim(); // 32-81

    Console.WriteLine("=== RESPUESTA AS400 ===");
    Console.WriteLine($"Código Error: {codigoError}");
    Console.WriteLine($"Descripción: {descripcion}");
}

