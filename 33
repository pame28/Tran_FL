
        [HttpPost]
        public async Task<IActionResult> BXIRegistrosCongeladosAsync([FromBody] RequestDto requestDto)
        {
            LogicalThreadContext.Properties["activityid"] = _uuid;
            CatalogoResponseDto catalogoResponseDto = new CatalogoResponseDto();
            List<AuthorizationResponseDto> lstAuthorizationDto = new List<AuthorizationResponseDto>();

            _logger.Info("***** BXIRegistrosCongeladosAsync *****");
            _logger.Info($"Equivalente: {requestDto.counterpart_card} | Canal: {requestDto.channel}");

            CatalogoResponse catalogoResponse = new CatalogoResponse();

            try
            {
                //Obtener los datos del cliente
                Client cliente = _repo.GetClient(requestDto.counterpart_card);
                if (cliente.document_number == "-1")
                {
                    _logger.Debug("No se encontr칩 informacion");
                    catalogoResponse = _repo.GetCatalogoResponse(2);
                    catalogoResponseDto = _mapper.Map<CatalogoResponseDto>(catalogoResponse);

                    var response = new Response<int>(catalogoResponseDto, 0);
                    _logger.Debug($"Respuesta: {StatusCode(StatusCodes.Status200OK, response)}");
                    return StatusCode(StatusCodes.Status200OK, response);
                }

                //Obtener los datos de la tarjeta
                Card card = _repo.GetCard(requestDto.counterpart_card);
                if (card.bin == "-1")
                {
                    _logger.Debug("No se encontr칩 informacion");
                    catalogoResponse = _repo.GetCatalogoResponse(2);
                    catalogoResponseDto = _mapper.Map<CatalogoResponseDto>(catalogoResponse);

                    var response = new Response<int>(catalogoResponseDto, 0);

                    _logger.Debug($"Respuesta: {StatusCode(StatusCodes.Status200OK, response)}");
                    return StatusCode(StatusCodes.Status200OK, response);
                }

                //Obtener el token
                _logger.Info("Obtener el token ");

                Token token = new Token();

                _logger.Debug("Consultando si existe un token en cache");
                if (memoryCache.Contains("BearerCache"))
                {
                    _logger.Debug("Existe un token en cache");
                    token.access_token = memoryCache.Get("BearerCache").ToString() ?? string.Empty;
                }

                if (string.IsNullOrEmpty(token.access_token) || string.IsNullOrWhiteSpace(token.access_token))
                {
                    _logger.Debug("No existe un token en cache");
                    token = await _repo.GetToken();
                    apiPrismaMemoryCacheOAUTH(token.access_token, Convert.ToInt32(token.expires_in));
                }

                TokenDto tokenDto = _mapper.Map<TokenDto>(token);

                //Obtener los registros 
                var lstRegistros = await _repo.GetAll(card, cliente, tokenDto.access_token);

                if (!lstRegistros.IsNullOrEmpty())
                {
                    catalogoResponse = _repo.GetCatalogoResponse(1);
                    catalogoResponseDto = _mapper.Map<CatalogoResponseDto>(catalogoResponse);

                    foreach (var item in lstRegistros)
                    {
                        lstAuthorizationDto.Add(_mapper.Map<AuthorizationResponseDto>(item));
                    }

                    Response<List<AuthorizationResponseDto>> response = new Response<List<AuthorizationResponseDto>>(catalogoResponseDto, lstAuthorizationDto);
                    _logger.Debug($"Respuesta: {Ok(response)}");
                    _logger.Info("Ejecucion exitosa");
                    return Ok(response);
                }
                else
                {
                    catalogoResponse = _repo.GetCatalogoResponse(2);
                    catalogoResponseDto = _mapper.Map<CatalogoResponseDto>(catalogoResponse);

                    var response = new Response<int>(catalogoResponseDto, 0);
                    _logger.Debug($"Respuesta: {Ok(response)}");
                    _logger.Info("Ejecucion exitosa");
                    return Ok(response);
                }
            }
            catch (Exception ex)
            {
                _logger.Error("Error en BXIRegistrosCongeladosAsync: ", ex);
                return BadRequest(ex.Message);
            }
        }




Mira este controlador es de un proyecto donde tengo que consumir mi microservicio,
aqui al principio tengo que colocar una condicion que, 
si la tarjeta est치 migrada entonces vaya a consumir mi microservicio y le devuelva la info que espera .... 
que basicamente este metodo responde exactamente igual a como lo hace mi microservicio.


Para realizar la validacion de si es migrada o no se tiene que consumir este Stored Procedure, ya est치 creado 
